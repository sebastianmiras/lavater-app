<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>4DLE25 ‚Äî NV2</title>
  <style>
    :root { --bg:#0b0f14; --panel:#111821; --text:#e6edf3; --muted:#9aa4af; --accent:#2e7d32; --max-width:1200px; --caption-size:clamp(18px,2.2vh + 0.6rem,28px); }
    html, body { height: 100%; }
    body { margin: 0; background: var(--bg); color: var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans"; display: grid; grid-template-rows: auto 1fr; }
    header { position: sticky; top: 0; z-index: 10; background: var(--panel); box-shadow: 0 2px 8px rgba(0,0,0,.35); }
    .bar { max-width: var(--max-width); margin: 0 auto; padding: .6rem 1rem; display: flex; align-items: center; gap: .75rem; flex-wrap: wrap; }
    .title { font-weight: 600; letter-spacing: .2px; }
    .spacer { flex: 1; }
    .btn { appearance:none; border:1px solid rgba(255,255,255,.12); background:rgba(255,255,255,.06); color:var(--text); padding:.45rem .7rem; border-radius:.6rem; cursor:pointer; font-size:.95rem; text-decoration:none; }
    .btn:hover { background:rgba(255,255,255,.12); }
    .btn:active { transform: translateY(1px); }
    .btn[disabled] { opacity:.5; cursor:not-allowed; }
    .stage { display:grid; place-items:center; }
    .frame { width:100%; max-width:var(--max-width); padding:.5rem 1rem 0; }
    figure { margin:0; }
    .image-wrap { position:relative; background:#000; display:grid; place-items:center; border-radius:.8rem; overflow:hidden; }
    img#slide { display:block; width:100%; height:auto; max-height:calc(100vh - 220px); object-fit:contain; image-rendering:auto; }
    .overlay-controls { position:absolute; inset:0; display:flex; align-items:center; justify-content:space-between; pointer-events:none; }
    .nav-btn { pointer-events:auto; background:rgba(0,0,0,.45); border:none; color:#fff; padding:.7rem .9rem; margin:.4rem; border-radius:.7rem; font-size:1.1rem; cursor:pointer; }
    .nav-btn:hover { background:rgba(0,0,0,.6); }
    figcaption { margin:.8rem 0 0; line-height:1.5; }
    .caption { font-size: var(--caption-size); }
    .meta { display:flex; align-items:baseline; gap:.8rem; color:var(--muted); margin-top:.25rem; font-size:.95rem; flex-wrap:wrap; }
    .chip { background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.12); border-radius:.5rem; padding:.15rem .45rem; font-size:.9rem; }
    .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; background: rgba(255,255,255,.08); padding: .15rem .35rem; border-radius: .35rem; }
    .hi-contrast img#slide { filter: contrast(1.1) saturate(1.05); }
    @media (max-height: 700px) { img#slide { max-height: calc(100vh - 190px); } }
  </style>
</head>
<body>
  <header>
    <div class="bar">
      <div class="title">4DLE25 ‚Äî Grupo <span id="groupName">NV2</span></div>
      <div id="counter">1 / 20</div>
      <div class="spacer"></div>
      <a class="btn" id="backBtn" href="./index.html" title="Volver al √≠ndice">‚Üê Volver al √≠ndice</a>
      <a class="btn" id="storyBtn" href="#" target="_blank" rel="noopener">üìñ Ver relato</a>
      <button class="btn" id="prevBtn" title="Anterior (‚Üê)">‚óÄ</button>
      <button class="btn" id="nextBtn" title="Siguiente (‚Üí o clic)">‚ñ∂</button>
      <button class="btn" id="fsBtn" title="Pantalla completa (F)">‚§¢ Pantalla completa</button>
      <button class="btn" id="zoomIn">A+</button>
      <button class="btn" id="zoomOut">A‚àí</button>
      <button class="btn" id="contrastBtn" title="Alto contraste">Alto contraste</button>
    </div>
  </header>

  <main class="stage">
    <div class="frame">
      <figure>
        <div class="image-wrap">
          <img id="slide" src="" alt="Secuencia C&J" />
          <div class="overlay-controls">
            <button class="nav-btn" id="overlayPrev" aria-label="Anterior">‚óÄ</button>
            <button class="nav-btn" id="overlayNext" aria-label="Siguiente">‚ñ∂</button>
          </div>
        </div>
        <figcaption>
          <div class="caption" id="captionText">Descripci√≥n de la secuencia‚Ä¶</div>
          <div class="meta">
            <span class="chip" id="phase">‚Äî</span>
            <span>Posici√≥n original: <span id="originalPos">‚Äî</span></span>
            <span>‚Ä¢</span>
            <span>Avanza con <span class="kbd">‚Üí</span>, <span class="kbd">Espacio</span> o clic</span>
          </div>
        </figcaption>
      </figure>
    </div>
  </main>

  <script>
    // ==========================
    // CONFIGURACI√ìN ‚Äî NV2
    // ==========================
    const GROUP_NAME = "NV2";

    // Im√°genes en /images/<id>.jpg (p√°gina situada en /4DLE25/)
    const PATH_PREFIX = "../images/";

    // Enlace opcional al relato de este grupo
    const STORY_URL = "./relatos/nv2.html"; // p. ej. "./relatos/NV2.html" o URL absoluta

    // Datos del grupo NV2 (orden, fases y descripciones)
    const DATA = [
      { id: 1,  fase: "Situaci√≥n inicial", descripcion: "√ârase una vez, una chica llamada Cenicienta, que se encontraba limpiando encerrada en su habitaci√≥n." },
      { id: 12, fase: "Situaci√≥n inicial", descripcion: "Cenicienta viv√≠a con su madrastra y sus dos hermanastras. Un d√≠a lleg√≥ la noticia de que se iba a celebrar un baile en el palacio real, lugar donde el pr√≠ncipe encontrar√≠a a su princesa. Entre peleas y nervios, las hermanas se preparaban para asistir al baile" },
      { id: 3,  fase: "Conflicto", descripcion: "Cenicienta, que tambi√©n quiere asistir al baile, se prepara con mucha alegr√≠a e ilusi√≥n en su habitaci√≥n. Sin embargo, como su familia no quiere que vaya, las hermanastras le rompen el vestido mientras se r√≠en de ella." },
      { id: 13, fase: "Conflicto", descripcion: "Cenicienta, llorando en su habitaci√≥n, ve c√≥mo las otras, junto a los caballeros, se van al baile real." },
      { id: 5,  fase: "Conflicto", descripcion: "En ese momento, Cenicienta se sorprende cuando aparece el Hada Madrina, dispuesta a llevarla al palacio con la ayuda de su varita m√°gica. Pronuncia las palabras bibidi babidi bu, le viste con un precioso vestido y unos zapatos de cristal. Adem√°s, transforma una calabaza en un gran carruaje y los ratones en fuertes caballos. Sin embargo, el hechizo solo durar√≠a hasta las doce de la noche.\n" },
      { id: 4,  fase: "Conflicto", descripcion: "Con su llegada al palacio, la familia observa enfadada y celosa c√≥mo aparece Cenicienta con un vestido azul y elegante.\n" },
      { id: 19, fase: "Desarrollo", descripcion: "Una vez dentro del palacio, el pr√≠ncipe, que hablaba con las hermanastras, se queda mirando asombrado la belleza de Cenicienta. Ambos comienzan a hablar, mientras que la madrastra y las hermanastras se alteran.\n\n" },
      { id: 7,  fase: "Desarrollo", descripcion: "Da comienzo el baile real, donde las hermanastras bailan con el pr√≠ncipe mientras que Cenicienta se queda sola observ√°ndolas.\n" },
      { id: 9,  fase: "Desarrollo", descripcion: "El pr√≠ncipe, ansioso, se acerca a Cenicienta con intenci√≥n de pedirle un baile. Ella acepta la propuesta y todos les miran sorprendidos." },
      { id: 8,  fase: "Desarrollo", descripcion: "Al final de la noche, ambos salen al balc√≥n para tener un momento m√°s tranquilo y evadirse de la multitud." },
      { id: 6,  fase: "Desarrollo", descripcion: "De repente, suenan las campanas, indicando que ya era casi medianoche, por lo que Cenicienta huye hacia el carruaje.\n" },
      { id: 10, fase: "Desarrollo", descripcion: "Ante las prisas, no se da cuenta de que se le cae por las escaleras del palacio uno de sus zapatos de cristal. \n" },
      { id: 20, fase: "Desarrollo", descripcion: "El pr√≠ncipe, pensando en por qu√© Cenicienta se ha marchado, se encuentra un zapato en las escaleras. Por ello, va preguntando a los invitados si saben de qui√©n es, mientras que todas est√°n desesperadas deseando que el zapato encaje en su pie.\n" },
      { id: 18, fase: "Resoluci√≥n", descripcion: "Ha pasado ya un tiempo y el pr√≠ncipe, junto a sus caballeros, llega a casa de la madrastra para seguir buscando a la due√±a del zapato.\n" },
      { id: 11, fase: "Resoluci√≥n", descripcion: "Mientras, Cenicienta est√° encerrada en su habitaci√≥n sin saber que el pr√≠ncipe est√° buscando a la persona que llevaba el zapato durante el baile.\n" },
      { id: 2,  fase: "Resoluci√≥n", descripcion: "El pr√≠ncipe, con permiso de la madrastra, entra en la casa preguntando si sabe de qui√©n es el zapato." },
      { id: 14, fase: "Resoluci√≥n", descripcion: "Por tanto, la primera de las hermanastras, emocionada, se dispone a probarse el zapato. No obstante, no le entra en el pie a pesar de la insistencia.\n" },
      { id: 15, fase: "Resoluci√≥n", descripcion: "La segunda de las hermanastras al ver que no le cab√≠a el zapato a su hermana, prueba a ver si le entra en el pie. Para su desgracia, le queda peque√±o." },
      { id: 16, fase: "Resoluci√≥n", descripcion: "En ese instante, el pr√≠ncipe descubre que hay una persona m√°s en la casa y le prueba a Cenicienta el zapato de cristal.\n" },
      { id: 17, fase: "Situaci√≥n final", descripcion: "Finalmente, todos los de la casa descubren que Cenicienta era la due√±a y su familia se muestra enfadada ante la situaci√≥n. A diferencia del pr√≠ncipe que expresa su gran alegr√≠a.\n" }
    ];

    // ==========================
    // L√ìGICA DE LA GALER√çA
    // ==========================
    document.title = `4DLE25 ‚Äî ${GROUP_NAME}`;
    document.getElementById('groupName').textContent = GROUP_NAME;

    const imgEl = document.getElementById('slide');
    const captionEl = document.getElementById('captionText');
    const counterEl = document.getElementById('counter');
    const phaseEl = document.getElementById('phase');
    const originalPosEl = document.getElementById('originalPos');

    // Bot√≥n de relato (se oculta si no hay URL)
    const storyBtn = document.getElementById('storyBtn');
    if (!STORY_URL) { storyBtn.style.display = 'none'; } else { storyBtn.href = STORY_URL; }

    const srcFor = (file) => PATH_PREFIX + encodeURIComponent(file);

    let i = 0; // √≠ndice actual
    let captionScale = 1;

    function show(index) {
      if (index < 0 || index >= DATA.length) return;
      i = index;
      const { id, descripcion, fase } = DATA[i];
      const file = `${id}.jpg`;
      imgEl.src = srcFor(file);
      imgEl.alt = `Secuencia ${i+1} de ${DATA.length}`;
      captionEl.textContent = descripcion || '';
      phaseEl.textContent = fase || '‚Äî';
      originalPosEl.textContent = id;
      counterEl.textContent = `${i+1} / ${DATA.length}`;

      // Habilitar/Deshabilitar navegaci√≥n
      document.getElementById('prevBtn').disabled = (i === 0);
      document.getElementById('overlayPrev').disabled = (i === 0);
      const atEnd = (i === DATA.length - 1);
      document.getElementById('nextBtn').disabled = atEnd;
      document.getElementById('overlayNext').disabled = atEnd;
    }

    function next() { if (i < DATA.length - 1) show(i+1); }
    function prev() { if (i > 0) show(i-1); }

    // Eventos UI
    document.getElementById('nextBtn').addEventListener('click', next);
    document.getElementById('prevBtn').addEventListener('click', prev);
    document.getElementById('overlayNext').addEventListener('click', next);
    document.getElementById('overlayPrev').addEventListener('click', prev);
    imgEl.addEventListener('click', next);

    // Teclado
    window.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); next(); }
      if (e.key === 'ArrowLeft') { e.preventDefault(); prev(); }
      if (e.key.toLowerCase() === 'f') { toggleFullscreen(); }
      if (e.key === '+') { zoomCaption(0.1); }
      if (e.key === '-') { zoomCaption(-0.1); }
    });

    // Pantalla completa
    const fsBtn = document.getElementById('fsBtn');
    fsBtn.addEventListener('click', toggleFullscreen);
    function toggleFullscreen() {
      const elem = document.documentElement;
      if (!document.fullscreenElement) { elem.requestFullscreen?.(); }
      else { document.exitFullscreen?.(); }
    }

    // Ajuste tama√±o de texto
    function setCaptionScale(scale) {
      captionScale = Math.max(0.6, Math.min(scale, 2.2));
      captionEl.style.fontSize = `calc(var(--caption-size) * ${captionScale})`;
    }
    function zoomCaption(delta) { setCaptionScale(captionScale + delta); }
    document.getElementById('zoomIn').addEventListener('click', () => zoomCaption(0.1));
    document.getElementById('zoomOut').addEventListener('click', () => zoomCaption(-0.1));

    // Alto contraste
    document.getElementById('contrastBtn').addEventListener('click', () => document.body.classList.toggle('hi-contrast'));

    // Inicio
    show(0);
  </script>
</body>
</html>
